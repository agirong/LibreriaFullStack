@page "/registrar-libro"
@inject HttpClient Http

<MudPaper Class="pa-4 mx-auto mt-6" MaxWidth="600px" Elevation="4">
    <MudText Typo="Typo.h5" Class="mb-4">Registrar Libro</MudText>

    <EditForm Model="@libro" OnValidSubmit="GuardarLibro">
        <MudTextField Label="Título" bind-Value="libro.titulo" Required="true" />
        <MudNumericField Label="Año" bind-Value="libro.anio" Required="true" />
        <MudTextField Label="Género" bind-Value="libro.genero" />
        <MudTextField Label="Editorial" bind-Value="libro.editorial" />
        <MudNumericField Label="Páginas" bind-Value="libro.paginas" Required="true" />
        <MudNumericField Label="ID Autor" bind-Value="libro.idAutor" Required="true" />

        <MudButton Type="Submit" Variant="Filled" Color="Color.Primary" Class="mt-3">Registrar</MudButton>
    </EditForm>
</MudPaper>

@code {
    LibroDTO libro = new();

    private async Task GuardarLibro()
    {
        var response = await Http.PostAsJsonAsync("https://localhost:5001/api/libros", libro);
        if (response.IsSuccessStatusCode)
        {
            Console.WriteLine("Libro registrado correctamente.");
        }
        else
        {
            Console.WriteLine("Error al registrar libro.");
        }
    }

    public class LibroDTO
    {
        public int idLibro { get; set; }
        public string? titulo { get; set; }
        public int anio { get; set; }
        public string? genero { get; set; }
        public string? editorial { get; set; }
        public int paginas { get; set; }
        public int idAutor { get; set; }
    }
}
